---
title: 'Makefile Beginner Study Notes'
date: 2024-08-29
permalink: /posts/2024-08-29-blog-post-1/
excerpt: "Quick-start study notes and review guide for Makefile."
tags: 
    - C/C++
    - Notes
---

# üöß Under Construction

> Learning source: [20-Minute Lightning Fast Makefile Tutorial](https://www.bilibili.com/video/BV1tyWWeeEpp) By: [GeekHour](https://space.bilibili.com/102438649)<br>
> Recommendation: ‚≠ê‚≠ê‚≠ê‚≠ê

---

## Build

### Definition

$$
\{ \text{Source files, resource files} \} \rightarrow \text{Executable file}
$$

### Process

$$
\{ \text{Source file} \} \rightarrow \{ \text{Preprocessing} \} \rightarrow \{ \text{Compilation} \} \rightarrow 
\{ \text{Assembly} \} \rightarrow \{ \text{Linking} \} \rightarrow \{ \text{Packaging/Deployment} \}
$$

### How to build

1. For a single file, we can directly use a compilation command to build the program.
2. For multiple source files and resources, using an **automated build system** is a better choice.

---

## Learning Make

Repository: [Code Repo](https://github.com/BaoZhuhan/TechStack/tree/main/Make)

---

### Compiling and Running Source Files with Commands

Create a file `main.c` with a simple C program:

```c
#include <stdio.h>

int main(){
    printf("Hello, World!\n");
    return 0;
}
```

In the shell[^1], enter:

[^1]: The author uses Windows 11; here ‚ÄúShell‚Äù generally refers to the Command Prompt. See [Microsoft official support](https://learn.microsoft.com/en-us/windows/terminal).

```shell
gcc main.c -o hello
```

This uses GCC[^2] to compile `main.c` into an executable.

[^2]: For installing GCC, see [FreeCodeCamp - How to Install C and C++ Compilers on Windows](https://www.freecodecamp.org/news/how-to-install-c-and-cpp-compiler-on-windows/).

Run with:

```shell
./hello
```

---

## Simple Usage of Make

1. Create a header file `message.h`

```c
void message();
```

2. Create `message.c`

```c
#include <stdio.h>

void message() {
    printf("Hello, World!\n");
}
```

3. Modify `main.c`

```diff
#include <stdio.h>
#include "message.h"

int main(){
+    message();
-    printf("Hello, World!\n");
    return 0;
}
```

4. Add a `Makefile`

```makefile
hello: main.c message.c
    gcc main.c message.c -o hello
```

---

## Make Best Practices

### 1. Step-by-step compilation

```makefile
hello: main.o message.o
    gcc main.o message.o -o hello

main.o: main.c
    gcc -c main.c

message.o: message.c
    gcc -c message.c
```

**Advantage**: If only `message.c` is modified, then `main.c` will not be recompiled.

---

### 2. Phony targets

```makefile
clean:
    rm -f *.o hello
```

**Note**: There must not be an actual file with the same name as the phony target.